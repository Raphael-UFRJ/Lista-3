---
title: "Simulação Monte Carlo em R"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

---
Questão 1: Modelo de Custo de Mão-de-Obra de Rebitagem
---

```{r}
q1 <- function(n) {
  # Tempo gasto por placa por rebitador
  tempos <- c(3.75, 5.5, 4.25)
  # Custo por hora de cada rebitador
  custos <- c(7.00, 8.50, 7.50)
  
  # Amostragem Monte Carlo
  custo_total <- replicate(n, {
    tempo <- sample(tempos, 1)
    custo_hora <- sample(custos, 1)
    custo_placa <- tempo * custo_hora
    custo_placa * 562
  })
  
  hist(custo_total, breaks = "FD", xlab = "Custo Total de Mão-de-Obra", main = "Histograma do Custo Total de Mão-de-Obra")
}

q1(10000)
```

---
Questão 2: Modelo de Custo Diário de Combustível para a Frota de Táxi
---

```{r}
q2 <- function(n) {
  # Carros ativos por dia
  carros_ativos <- c(15, 20, 18)
  # Consumo de gasolina por carro por dia (litros)
  consumo_gasolina <- c(40, 70, 58)
  # Custo variável por litro de gasolina
  custo_gasolina <- c(5.70, 7.20, 6.00)
  
  # Amostragem Monte Carlo
  custo_combustivel <- replicate(n, {
    carros <- sample(carros_ativos, 1)
    consumo <- sample(consumo_gasolina, 1)
    custo_litro <- sample(custo_gasolina, 1)
    custo_combustivel_dia <- carros * consumo * custo_litro
    custo_combustivel_dia
  })
  
  hist(custo_combustivel, breaks = "FD", xlab = "Custo Diário de Combustível", main = "Histograma do Custo Diário de Combustível")
}

# Chamada da função q2 com 10000 iterações
q2(10000)
```

---
Questão 3: Modelo de Lucro Total do Restaurante
---

```{r}
# 3-Um investidor deseja avaliar o retorno de um investimento em um restaurante.
#   Uma avalia ̧c ̃ao de especialistas mosstrou que:
#    1. cada cliente gasta (150, 500, 250)
#    2. receba a visita di ́aria de (40, 120, 60) clientes.
#    3. o lucrosobre o faturamento  ́e de (15% ,30%, 22%)
#  Calcule o risco do do lucro total do restaurante durante o primeiro ano de opera ̧c ̃ao,
#  assumindo que o restaurante opera 300 dias por ano.

# Definindo os dados
gastoCliente <- c(150, 500, 250)
clientesDiarios <- c(40, 120, 60)
margemLucro <- c(0.15, 0.30, 0.22)
operacaoAno <- 300

# Função para calcular o lucro diário
calcularLucroDiario <- function() {
  gastoAleatorio <- sample(gastoCliente, 1)
  clientesAleatorios <- sample(clientesDiarios, 1)
  margemAleatoria <- sample(margemLucro, 1)
  
  faturamentoDiario <- gastoAleatorio * clientesAleatorios
  lucroDiario <- faturamentoDiario * margemAleatoria
  
  return(lucroDiario)
}

# Realizando calculo do lucro anual
lucroAnual <- replicate(operacaoAno, calcularLucroDiario())

# Calculando a média e o desvio padrão dos lucros diários
mediaLucrosDiarios <- mean(lucroAnual)
desvioPadraoLucrosDiarios <- sd(lucroAnual)

# Calculando o risco do lucro total
riscoLucroTotal <- desvioPadraoLucrosDiarios * sqrt(operacaoAno)

# Exibindo o resultado
cat("O risco do lucro total do restaurante durante o primeiro ano de operação é de aproximadamente:", riscoLucroTotal, "\n")
```
